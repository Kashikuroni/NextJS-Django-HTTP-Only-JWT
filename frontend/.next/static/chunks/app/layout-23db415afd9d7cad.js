(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{2793:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,4147,23)),Promise.resolve().then(a.t.bind(a,8489,23)),Promise.resolve().then(a.t.bind(a,347,23)),Promise.resolve().then(a.bind(a,2561))},2561:(e,t,a)=>{"use strict";a.d(t,{A:()=>u,AuthProvider:()=>h});var r=a(5155),s=a(2115),i=a(6046),o=a(8755),n=a(8287);let l=(0,s.createContext)(void 0),h=e=>{let{children:t}=e,[a,h]=(0,s.useState)(!1),[u,c]=(0,s.useState)(!0),[d,p]=(0,s.useState)(null),w=(0,i.useRouter)(),m=(0,i.usePathname)();return(0,s.useEffect)(()=>{(async()=>{if(c(!0),n.H.includes(m)){c(!1);return}try{let e=await o.A.getUser();p(e),h(!0)}catch(e){try{await o.A.refreshToken();let e=await o.A.getUser();p(e),h(!0)}catch(e){w.push(n.$)}}finally{c(!1)}})()},[m]),(0,r.jsx)(l.Provider,{value:{isAuthenticated:a,loading:u,user:d},children:t})},u=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},8755:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(2651),s=a(7358);class i{mergeHeaders(e){let t={"Content-Type":"application/json"},a=localStorage.getItem("userToken");return a&&(t.Authorization="Token ".concat(a)),{...t,...e}}async post(e,t,a){let r={headers:this.mergeHeaders(a)};return(await this.api.post(e,t,r)).data}async get(e,t){let a={headers:this.mergeHeaders(t)};return(await this.api.get(e,a)).data}async put(e,t,a){let r={headers:this.mergeHeaders(a)};try{return(await this.api.put(e,t,r)).data}catch(e){throw this.handleError(e)}}async delete(e,t){let a={headers:this.mergeHeaders(t)};try{return(await this.api.delete(e,a)).data}catch(e){throw this.handleError(e)}}constructor(){this.handleError=e=>{var t;return{status:e.status,message:e.message,data:null===(t=e.response)||void 0===t?void 0:t.data}};let e=s.env.NEXT_PUBLIC_DEVELOPMENT_HOST||"http://localhost:8000";this.api=r.A.create({baseURL:e,withCredentials:!0})}}class o extends i{async register(e){try{return await this.post("api/auth/v1/register/",e)}catch(e){if(r.A.isAxiosError(e)&&e.response&&e.response.data){let t=e.response.data;if(t.email||t.username)throw Error("Указанные данные уже используются. Пожалуйста, проверьте введенные данные.");throw Error("Произошла ошибка. Пожалуйста, попробуйте ещё раз.")}}}async login(e){return await this.post("/api/auth/v1/login/",e)}async logout(){return await this.post("/api/auth/v1/logout/")}async deleteAccount(){return await this.delete("/api/auth/v1/users/delete/")}async getUser(){return await this.get("/api/auth/v1/users/")}async refreshToken(){let e=await this.post("/api/auth/v1/refresh/");if(!e||"boolean"!=typeof e.success)throw Error("Invalid response format.");if(!e.success)throw Error(e.message||"Failed to refresh token.");return e}async updateProfile(e){return await this.put("/api/auth/v1/users/",e,{"Content-Type":"multipart/form-data"})}async changePassword(e){return await this.post("/api/users/set_password/",e)}}let n=new o},8287:(e,t,a)=>{"use strict";a.d(t,{$:()=>r,H:()=>s});let r="/auth/login",s=["/auth/login","/auth/register"]},347:()=>{},4147:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_4d318d",variable:"__variable_4d318d"}},8489:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_ea5f4b",variable:"__variable_ea5f4b"}}},e=>{var t=t=>e(e.s=t);e.O(0,[896,238,441,517,358],()=>t(2793)),_N_E=e.O()}]);