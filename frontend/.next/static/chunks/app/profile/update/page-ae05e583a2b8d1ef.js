(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{964:(e,t,r)=>{Promise.resolve().then(r.bind(r,9827)),Promise.resolve().then(r.bind(r,9214)),Promise.resolve().then(r.bind(r,2904))},6046:(e,t,r)=>{"use strict";var a=r(6658);r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},9827:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let a=r(3719);function s(e){let{reason:t,children:r}=e;if("undefined"==typeof window)throw new a.BailoutToCSRError(t);return r}},9214:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return i}});let a=r(5155),s=r(7650),n=r(5861),l=r(8284);function i(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let r=n.workAsyncStorage.getStore();if(void 0===r)return null;let i=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files;i.push(...t)}}return 0===i.length?null:(0,a.jsx)(a.Fragment,{children:i.map(e=>{let t=r.assetPrefix+"/_next/"+(0,l.encodeURIPath)(e);return e.endsWith(".css")?(0,a.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,s.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}},2904:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var a=r(5155),s=r(2115),n=r(6046),l=r(2561),i=r(8755);let o=e=>{let{onUpload:t,imageUrl:r,width:n,height:l}=e,[i,o]=(0,s.useState)(r||null);return(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsxs)("label",{htmlFor:"image-upload",className:"relative ".concat(n," ").concat(l," rounded-2xl overflow-hidden cursor-pointer border-2 border-dashed border-gray-300 bg-gray-100 hover:bg-gray-200 transition duration-300"),children:[i?(0,a.jsx)("img",{src:i,alt:"Uploaded Preview",className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"flex items-center justify-center w-full h-full text-gray-500 text-sm font-semibold",children:"Загрузить изображение"}),(0,a.jsx)("input",{id:"image-upload",type:"file",accept:"image/*",className:"hidden",onChange:e=>{if(e.target.files&&e.target.files[0]){let r=e.target.files[0];o(URL.createObjectURL(r)),t(r)}}})]})})};var u=r(2878);let d=()=>{let{user:e,refreshUser:t}=(0,l.A)(),r=(0,n.useRouter)(),[d,c]=(0,s.useState)({username:"",firstName:"",lastName:""}),[h,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{e&&c({username:e.username||"",firstName:e.first_name||"",lastName:e.last_name||""})},[e]);let p=e=>{c({...d,[e.target.name]:e.target.value})},m=async e=>{e.preventDefault();let a=new FormData;a.append("username",d.username),a.append("first_name",d.firstName),a.append("last_name",d.lastName),h&&a.append("avatar",h);try{await i.A.updateProfile(a),await t(),r.push("/profile/")}catch(e){console.error("Failed to update profile:",e)}};return(0,a.jsxs)("div",{className:"flex h-full justify-center items-center gap-4 p-4",children:[(0,a.jsx)(o,{width:"w-52",height:"h-52",imageUrl:(null==e?void 0:e.avatar)||"/default-avatar.png",onUpload:e=>{f(e)}}),(0,a.jsx)("div",{className:"flex flex-col h-full justify-center w-full",children:(0,a.jsxs)("form",{onSubmit:m,className:"flex flex-col gap-2",children:[(0,a.jsx)(u.a,{label:"Username",id:"username",name:"username",value:d.username,onChange:p}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u.a,{label:"First name",id:"firstName",name:"firstName",value:d.firstName,onChange:p}),(0,a.jsx)(u.a,{label:"Last name",id:"lastName",name:"lastName",value:d.lastName,onChange:p})]}),(0,a.jsx)("p",{className:"text-gray-600 text-sm",children:null==e?void 0:e.email}),(0,a.jsx)("button",{type:"submit",className:"bg-green-500 text-white font-bold px-5 py-2 rounded-lg hover:bg-green-600",children:"Save"})]})})]})}},2878:(e,t,r)=>{"use strict";r.d(t,{a:()=>i});var a=r(5155),s=r(4617),n=r.n(s),l=r(2115);let i=e=>{let{id:t,type:r="text",name:s,label:i,value:o,onChange:u,placeholder:d,required:c=!1,...h}=e,[f,p]=(0,l.useState)(null),[m,g]=(0,l.useState)(!1),v=n()("text-sm font-light text-gray-600"),y=n()("w-full text-sm py-1 px-2 bg-transparent","border-2 rounded-md",f?"border-red-500":"border-gray-300","placeholder-gray-300","hover:ring-blue-400 hover:ring hover:border-transparent","focus:ring-blue-400 focus:ring focus:border-transparent","transition-all duration-300 ease-in-out","appearance-none outline-none"),x=n()("absolute text-red-500 text-xs transition-all duration-300 ease-in-out bg-white px-2 py-1 rounded shadow-md","mt-1 left-0 top-full z-40"),w=e=>{e.checkValidity()?p(null):p(e.validationMessage)};return(0,a.jsxs)("div",{className:"flex flex-col gap-2 w-full h-full justify-center items-start",children:[(0,a.jsx)("label",{className:v,htmlFor:t,children:i}),(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("input",{className:y,id:t,type:r,name:s,value:o,onChange:e=>{u&&u(e),m&&w(e.target)},onBlur:e=>{g(!0),w(e.target)},placeholder:d,required:c,...h}),m&&f&&(0,a.jsx)("span",{className:n()(x,f?"opacity-100 scale-100":"opacity-0 scale-95","transition-all duration-300"),children:f||""})]})]})}},2561:(e,t,r)=>{"use strict";r.d(t,{A:()=>o,AuthProvider:()=>i});var a=r(5155),s=r(2115),n=r(8755);let l=(0,s.createContext)(void 0),i=e=>{let{children:t}=e,[r,i]=(0,s.useState)(null),[o,u]=(0,s.useState)(!1),[d,c]=(0,s.useState)(!0),h=async()=>{try{let e=await n.A.getUser();i(e),u(!0)}catch(e){console.error("Failed to refresh user data:",e),i(null),u(!1)}finally{c(!1)}};return(0,s.useEffect)(()=>{h()},[]),(0,a.jsx)(l.Provider,{value:{user:r,isAuthenticated:o,loading:d,refreshUser:h,clearAuth:()=>{i(null),u(!1)}},children:t})},o=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},8755:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(2651),s=r(7358);class n{mergeHeaders(e){return{"Content-Type":"application/json",...e}}async post(e,t,r){let a={headers:this.mergeHeaders(r)};return(await this.api.post(e,t,a)).data}async get(e,t){let r={headers:this.mergeHeaders(t)};return(await this.api.get(e,r)).data}async put(e,t,r){let a={headers:this.mergeHeaders(r)};try{return(await this.api.put(e,t,a)).data}catch(e){throw this.handleError(e)}}async delete(e,t){let r={headers:this.mergeHeaders(t)};try{return(await this.api.delete(e,r)).data}catch(e){throw this.handleError(e)}}constructor(){this.handleError=e=>{var t;return{status:e.status,message:e.message,data:null===(t=e.response)||void 0===t?void 0:t.data}};let e=s.env.NEXT_PUBLIC_DEVELOPMENT_HOST||"http://localhost:8000";this.api=a.A.create({baseURL:e,withCredentials:!0})}}class l extends n{async register(e){try{return await this.post("api/auth/v1/register/",e)}catch(e){if(a.A.isAxiosError(e)&&e.response&&e.response.data){let t=e.response.data;if(t.email||t.username)throw Error("Указанные данные уже используются. Пожалуйста, проверьте введенные данные.");throw Error("Произошла ошибка. Пожалуйста, попробуйте ещё раз.")}}}async login(e){return await this.post("/api/auth/v1/login/",e)}async logout(){return await this.post("/api/auth/v1/logout/")}async deleteAccount(){return await this.delete("/api/auth/v1/users/delete/")}async getUser(){return await this.get("/api/auth/v1/users/",{"Cache-Control":"no-store"})}async refreshToken(){let e=await this.post("/api/auth/v1/refresh/");if(!e||"boolean"!=typeof e.success)throw Error("Invalid response format.");if(!e.success)throw Error(e.message||"Failed to refresh token.");return e}async updateProfile(e){return await this.put("/api/auth/v1/users/",e,{"Content-Type":"multipart/form-data"})}async changePassword(e){return await this.post("/api/users/set_password/",e)}}let i=new l},4617:(e,t)=>{var r;!function(){"use strict";var a={}.hasOwnProperty;function s(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=n(e,function(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return s.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)a.call(e,r)&&e[r]&&(t=n(t,r));return t}(r)))}return e}function n(e,t){return t?e?e+" "+t:e+t:e}e.exports?(s.default=s,e.exports=s):void 0!==(r=(function(){return s}).apply(t,[]))&&(e.exports=r)}()}},e=>{var t=t=>e(e.s=t);e.O(0,[651,441,517,358],()=>t(964)),_N_E=e.O()}]);